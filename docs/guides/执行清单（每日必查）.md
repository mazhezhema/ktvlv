# 执行清单（每日必查）

> **文档版本**：v1.0  
> **最后更新**：2025-12-30  
> **状态**：✅ 定版（每日必查）  
> **用途**：PM 每日 code review 检查清单

---

## 📋 每日检查清单（5分钟）

### 🔴 必须检查（发现即叫停）

- [ ] **今天有没有新增线程？**
  - 搜索 `std::thread`、`pthread_create`
  - **有 = 停**

- [ ] **有没有绕 Controller？**
  - UI 是否直接调用 Service？
  - Service 是否直接操作 UI？
  - **有 = 返工**

- [ ] **Adapter 接口是否被改？**
  - 检查 `src/adapter/*.h` 是否有变更
  - **改 = 你审**

- [ ] **是否还能同步+loading 顶住？**
  - 是否有并发请求？
  - 是否有架构升级？
  - **能 = 不升级**

---

## 🔍 检查命令（可直接执行）

### 1. 检查新增线程

```bash
# 搜索新增的线程创建代码
git diff HEAD | grep -E "std::thread|pthread_create"

# 搜索所有线程创建代码
grep -r "std::thread\|pthread_create" src/
```

**结果判断**：
- ✅ 无结果 → 通过
- ❌ 有结果 → **立即叫停**

---

### 2. 检查是否绕 Controller

```bash
# 检查 UI 是否直接调用 Service
grep -r "Service::instance()" src/ui/

# 检查 Service 是否操作 UI
grep -r "lv_obj_" src/services/ src/features/

# 检查 UI 是否直接调用 NetworkService
grep -r "NetworkService::" src/ui/
```

**结果判断**：
- ✅ 无结果 → 通过
- ❌ 有结果 → **立即返工**

---

### 3. 检查 Adapter 接口变更

```bash
# 检查 Adapter 接口是否有变更
git diff HEAD src/adapter/*.h

# 检查 Adapter 接口文件
ls -la src/adapter/*.h
```

**结果判断**：
- ✅ 无变更 → 通过
- ❌ 有变更 → **必须 PM review**

---

### 4. 检查架构升级

```bash
# 检查是否有并发相关代码
grep -r "std::async\|std::future" src/

# 检查是否有预加载相关代码
grep -r "preload\|prefetch" src/

# 检查是否有重试相关代码
grep -r "retry\|Retry" src/
```

**结果判断**：
- ✅ 无结果 → 通过
- ❌ 有结果 → **立即叫停，问：能不能用 loading 顶住？**

---

### 5. 检查依赖方向

```bash
# 检查 UI 是否 include Service
grep -r "#include.*service" src/ui/ | grep -v "event_queue"

# 检查 Service 是否 include UI
grep -r "#include.*ui" src/services/ src/features/
```

**结果判断**：
- ✅ UI 只能 include `events/event_queue.h` 和 Controller
- ✅ Service 不能 include UI
- ❌ 违反 → **立即返工**

---

### 6. 检查页面 create/destroy

```bash
# 检查页面是否 create/destroy
grep -r "new.*Page\|delete.*page" src/
grep -r "Page::create\|Page::destroy" src/

# 检查是否使用 show/hide
grep -r "\.show()\|\.hide()" src/ui/
```

**结果判断**：
- ✅ 使用 `show()/hide()` → 通过
- ❌ 使用 `create/destroy` → **立即返工**

---

### 7. 检查 Controller 越权

```bash
# 检查 Controller 是否解析 JSON
grep -r "cJSON_Parse\|json_parse" src/features/*/Controller.*

# 检查 Controller 是否做业务逻辑
grep -r "curl_easy_init\|sqlite3_open" src/features/*/Controller.*
```

**结果判断**：
- ✅ Controller 只调用 Service → 通过
- ❌ Controller 做业务逻辑 → **立即返工**

---

### 8. 检查新增全局对象

```bash
# 检查新增的 Singleton
git diff HEAD | grep -E "static.*instance\(\)|Singleton"

# 检查新增的全局变量
git diff HEAD | grep -E "^\+.*g_|^\+.*global_"
```

**结果判断**：
- ✅ 无新增 → 通过
- ❌ 有新增 → **必须 PM 批准**

---

### 9. 检查命名规范

```bash
# 检查 Controller 命名
grep -r "onUi\|onSvc\|handle" src/features/*/Controller.*

# 检查是否使用正确的命名
grep -r "void.*play()\|void.*search()" src/features/*/Controller.*
```

**结果判断**：
- ✅ 使用 `onUiXxx`、`onSvcXxx`、`handleXxx` → 通过
- ❌ 使用 `play()`、`search()` → **需要修改为 `onUiPlayClicked()` 等**

---

### 10. 检查 libcurl 使用

```bash
# 检查是否有直接使用 libcurl
grep -r "curl_easy_init\|curl_easy_perform" src/ | grep -v "network_service"

# 检查是否有多个 NetworkService 实例
grep -r "NetworkService" src/ | grep -v "network_service.h\|network_service.cpp"
```

**结果判断**：
- ✅ libcurl 只在 `NetworkService` 中使用 → 通过
- ❌ 其他地方使用 libcurl → **立即返工**

---

## 📊 每日检查结果记录

### 检查日期：_______

| 检查项 | 结果 | 备注 |
|--------|------|------|
| 新增线程 | ✅/❌ | |
| 绕 Controller | ✅/❌ | |
| Adapter 接口变更 | ✅/❌ | |
| 架构升级 | ✅/❌ | |
| 依赖方向 | ✅/❌ | |
| 页面 create/destroy | ✅/❌ | |
| Controller 越权 | ✅/❌ | |
| 新增全局对象 | ✅/❌ | |
| 命名规范 | ✅/❌ | |
| libcurl 使用 | ✅/❌ | |

**任何一项为 ❌，立即叫停并返工。**

---

## 💬 PM 话术（直接说）

### 发现违反铁律时

> **违反铁律 = 返工，不需要讨论。  
> 请按照《10条铁律》和《模块责任表》重新实现。**

---

### 发现架构升级时

> **这个架构升级需要产品需求支撑。  
> 如果用户没有这个需求，我们不应该提前做架构升级。  
> 能不能先用 loading 顶住？**

---

### 发现越界时

> **这个功能超出了你的职责范围。  
> 请参考《模块责任表》，明确你的职责边界。  
> 如果需要调整职责，必须先找我讨论。**

---

## 📚 相关文档

- [Tina_KTV项目10条铁律（贴墙版）.md](./Tina_KTV项目10条铁律（贴墙版）.md) ⭐⭐⭐ **必读**
- [模块责任表（RACI最终版）.md](./模块责任表（RACI最终版）.md) ⭐⭐⭐ **必读**
- [代码目录结构等于模块责任结构（定版）.md](./代码目录结构等于模块责任结构（定版）.md) ⭐⭐⭐ **必读**

---

**最后更新**: 2025-12-30  
**状态**: ✅ 定版（每日必查）  
**维护者**: Tech Product Owner


