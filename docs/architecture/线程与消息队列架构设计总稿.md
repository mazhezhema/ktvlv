# KTVLVï¼ˆF133/TinaLinuxï¼‰é¡¹ç›®çº¿ç¨‹å¹¶å‘ & æ¶ˆæ¯é˜Ÿåˆ—ä½“ç³»æ€»åˆ†æ

> **æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
> **æœ€åæ›´æ–°**ï¼š2025-12-30  
> **é¡¹ç›®åç§°**ï¼šKTVLV  
> **ç›®æ ‡å¹³å°**ï¼šå…¨å¿— F133ï¼ˆARM Cortex-A7ï¼‰  
> **æ“ä½œç³»ç»Ÿ**ï¼šTina Linux

---

## ğŸ“Œ å®šä½ä¸€å¥è¯

**ä¸»çº¿ç¨‹è´Ÿè´£ UIï¼Œæ’­æ”¾å™¨å•çº¿ç¨‹ä¸²è¡Œè°ƒåº¦ï¼Œç½‘ç»œä»»åŠ¡å¼‚æ­¥å¹¶å› UIï¼ŒSDK äº‹ä»¶é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—å›æµï¼Œä¸šåŠ¡å±‚å…¨ç¨‹æ— é”ã€‚**

---

## ğŸ§  æ ¸å¿ƒç›®æ ‡

- âœ… å°½é‡é **æ¶æ„é¿å…å¹¶å‘é—®é¢˜**ï¼Œè€Œä¸æ˜¯ä¾èµ–é”æˆ–"å·¥ç¨‹å¸ˆå°å¿ƒç‚¹"
- âœ… UI/ä¸šåŠ¡å¼€å‘è€…ï¼ˆJava/Web èƒŒæ™¯ï¼‰**ä¸æ¥è§¦é” / ä¸æ¥è§¦pthread**
- âœ… çŠ¶æ€ä¸€è‡´æ€§ ï¼ æ€§èƒ½ç‚«æŠ€
- âœ… MVP é˜¶æ®µæˆæœ¬ï¼†æ¦‚ç‡æ­£ç¡® ï¼ ç†è®ºæœ€ä¼˜

---

## ğŸ§± çº¿ç¨‹ä½“ç³»ï¼ˆå…¨å±€åœ°å›¾ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            ç³»ç»Ÿçº§çº¿ç¨‹                         â”‚
â”‚    ğŸ§ tplayerå†…éƒ¨çº¿ç¨‹  â† SDKå›è°ƒ â†’  æ¨äº‹ä»¶/çŠ¶æ€ â†’ UiEventQueue â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          åº”ç”¨ä¾§çº¿ç¨‹                           â”‚
â”‚                                                                â”‚
â”‚  ğŸ–¥ï¸UIä¸»çº¿ç¨‹(LVGL) â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ UiEventQueue â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚     â†‘   â”‚  UIæ¸²æŸ“ï½œæ§ä»¶çŠ¶æ€                                   â”‚ â”‚ å›è°ƒæ´¾å‘
â”‚     â”‚   â”‚                                                   â”‚ â”‚
â”‚     â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚ â”‚
â”‚     â”‚                       â”‚                               â”‚ â”‚
â”‚     â”‚   PlayerAdapterAPI è°ƒåº¦                               â”‚ â”‚
â”‚     â–¼                       â”‚                               â”‚ â”‚
â”‚  ğŸ›ä¸šåŠ¡è°ƒç”¨â†’PlayerCmdQueueâ†’ğŸ§æ’­æ”¾å™¨çº¿ç¨‹(std::thread)â†’tplayer  â”‚ â”‚
â”‚                                                                â”‚
â”‚  ğŸŒç½‘ç»œçº¿ç¨‹(std::async) â†’ HTTP/JSON â†’ å›UIäº‹ä»¶ â†’ UiEventQueue â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> **çº¿ç¨‹ç­–ç•¥å®šä½ = ä¸» UIã€ç½‘ç»œå¼‚æ­¥ã€æ’­æ”¾å™¨ä¸²è¡Œã€SDKä¸å¯æ§**  
> æˆ‘ä»¬ç”¨"æ¶æ„å°è£…"éš”ç¦» SDK çš„ä¸ç¡®å®šæ€§ã€‚

---

## ğŸ” æ¶ˆæ¯é˜Ÿåˆ—è¯´æ˜ï¼ˆå…¨é¡¹ç›®ä»… 2 ä¸ªï¼‰

| é˜Ÿåˆ— | åŠŸèƒ½å®šä½ | ç”Ÿäº§è€… | æ¶ˆè´¹è€… | ä¸ºä»€ä¹ˆå­˜åœ¨ | å®ç°é€‰å‹ |
|------|---------|--------|--------|-----------|---------|
| **PlayerCmdQueue** | ä¸²è¡ŒåŒ–æ’­æ”¾å™¨æ‰€æœ‰åŠ¨ä½œï¼ˆå‘½ä»¤è¾“å…¥ï¼‰ | UI/ç½‘ç»œ/ä¸šåŠ¡ | ğŸ§æ’­æ”¾å™¨çº¿ç¨‹ | ç¡®ä¿ tplayerè°ƒç”¨é¡ºåºä¸€è‡´æ€§ | `std::queue + std::mutex`ï¼ˆå•æ¶ˆè´¹è€…ï¼‰ |
| **UiEventQueue** | å°†åå°äº‹ä»¶å›æµUIçº¿ç¨‹ï¼ˆäº‹ä»¶è¾“å‡ºï¼‰ | æ’­æ”¾å™¨/ç½‘ç»œ/SDK | ğŸ–¥ï¸UIçº¿ç¨‹ | ä¿è¯UIæ›´æ–°åœ¨æ­£ç¡®ä¸Šä¸‹æ–‡ | `std::queue + std::mutex`ï¼ˆå¤šç”Ÿäº§è€…ï¼ŒMVPé˜¶æ®µç»Ÿä¸€ä½¿ç”¨æ ‡å‡†åº“ï¼‰ |

ğŸ“Œ **è¿™ä¿©é˜Ÿåˆ—=æ•´ä¸ªç³»ç»Ÿ"å‘½ä»¤æµ+äº‹ä»¶æµ"é—­ç¯çš„é¾™éª¨ç»“æ„**  
ğŸ“Œ ä¸šåŠ¡æ°¸è¿œ**åªç«™åœ¨å‘½ä»¤å…¥å£** or **UIäº‹ä»¶å‡ºå£**

> **æ³¨æ„**ï¼šä¸åŒåŸŸçš„äº‹ä»¶ç”¨ä¸åŒçš„é˜Ÿåˆ—ï¼Œä½†éµå¾ªç»Ÿä¸€çš„"äº‹ä»¶â†’é˜Ÿåˆ—â†’çº¿ç¨‹æ¶ˆè´¹"æ¶æ„æ¨¡å¼ã€‚  
> è¯¦è§ï¼š[äº‹ä»¶æ¶æ„è§„èŒƒ.md](./äº‹ä»¶æ¶æ„è§„èŒƒ.md)

---

## ğŸ¯ ä¸šåŠ¡æ“ä½œâ†’å‘½ä»¤æ˜ å°„ï¼ˆå…¨é‡ï¼‰

| æ“ä½œ | å‘½ä»¤ | ä¼ å‚ | æœ€ç»ˆè½¬åŒ– |
|------|------|------|---------|
| ç‚¹æ­Œ | PLAY | URL | stopâ†’prepareâ†’start |
| åˆ‡æ­Œ | PLAY | URL | åŒä¸Š |
| æš‚åœ | PAUSE | - | tplayer_pause() |
| ç»§ç»­ | RESUME | - | tplayer_resume() |
| é‡å”± | REPLAY | - | tplayer_seek(0) |
| åˆ‡åŸä¼´å¥ | SWITCH_TRACK | mode | tplayer_set_track() |
| è°ƒéŸ³é‡ | SET_VOLUME | value | tplayer_set_volume() |
| é€€å‡ºæ’­æ”¾å™¨ | EXIT | - | stopâ†’releaseâ†’state=Idle |

> **æ‰€æœ‰è¡Œä¸ºåªå­˜åœ¨äºå‘½ä»¤è¯­ä¹‰ï¼Œä¸åšè·¨çº¿ç¨‹çŠ¶æ€æ‹¼å›¾**  
> **æ‹’ç»ç›´æ¥ç‚¹ tplayer API**

---

## ğŸ› å‘½ä»¤æšä¸¾ï¼ˆC++æœ€ç»ˆç‰ˆï¼‰

```cpp
enum class PlayerCmdType {
    PLAY,           // æ’­æ”¾/åˆ‡æ­Œ
    PAUSE,          // æš‚åœ
    RESUME,         // ç»§ç»­
    REPLAY,         // é‡å”±
    SWITCH_TRACK,   // åˆ‡æ¢éŸ³è½¨ï¼ˆåŸå”±/ä¼´å¥ï¼‰
    SET_VOLUME,     // è®¾ç½®éŸ³é‡
    STOP,           // åœæ­¢
    EXIT            // é€€å‡ºæ’­æ”¾å™¨
};

struct PlayerCmd {
    PlayerCmdType type;
    std::string url;    // PLAYç”¨
    int value = 0;      // SET_VOLUME / SWITCH_TRACK ç”¨
};
```

> UIå±‚å”¯ä¸€å·¥ä½œï¼š`Player::play(url)` / `pause()` / `exit()`  
> å…¶ä»–ä¸ç”¨æƒ³ã€‚

---

## ğŸ“¡ äº‹ä»¶æµï¼ˆSDKâ†’UIï¼‰

```cpp
enum class PlayerEventType {
    PREPARING,      // å‡†å¤‡ä¸­
    PLAYING,        // æ’­æ”¾ä¸­
    PAUSED,         // å·²æš‚åœ
    STOPPED,        // å·²åœæ­¢
    COMPLETED,      // æ’­æ”¾å®Œæˆ
    ERROR           // é”™è¯¯
};

struct PlayerEvent {
    PlayerEventType type;
    int progress_ms;    // æ’­æ”¾è¿›åº¦ï¼ˆæ¯«ç§’ï¼‰
    int error_code;     // é”™è¯¯ç ï¼ˆå¦‚æœæœ‰ï¼‰
    std::string error_msg;  // é”™è¯¯ä¿¡æ¯
};
```

> **æ’­æ”¾å™¨çº¿ç¨‹è´Ÿè´£æŠŠSDKäº‹ä»¶ç¿»è¯‘æˆ PlayerEvent**  
> **UIçº¿ç¨‹é€šè¿‡ UiEventQueue ç»Ÿä¸€æ¶ˆè´¹**

---

## ğŸ§¬ å¹¶å‘é€‰å‹åˆ†æï¼ˆæ·±å…¥ç‰ˆï¼‰

| æ–¹æ¡ˆ | ç»“æœ |
|------|------|
| **std::thread** | âœ”ï¸ è·¨å¹³å°å†…ç½®ã€è¯­ä¹‰ç®€å•ã€ç¬¦åˆMVPæŠ•å…¥äº§å‡º |
| pthreadæš´éœ²ç»™ä¸šåŠ¡ | âŒ æ‹’ç»ï¼›éš¾åº¦é«˜ã€æ˜“æ»¥ç”¨ã€ä¸å…¼å®¹å›¢é˜ŸèƒŒæ™¯ |
| lock-freeé˜Ÿåˆ—ï¼ˆmoodycamelï¼‰ | âŒ è¿‡åº¦è®¾è®¡ï¼›MPMCæ¨¡å‹æ— æ”¶ç›Š |
| å…¨å±€EventBus + å¤šçº¿ç¨‹è®¢é˜… | âš ï¸ å¯åšï¼Œä½†å½“å‰æ¶æ„æ”¶ç›Šæœ‰é™ |
| Actoræ¨¡å‹ / åç¨‹æ¡†æ¶ | âš ï¸ æœªæ¥å¼€ä¼˜åŒ–ç‰ˆè®®é¢˜ï¼›ç°åœ¨ä¸æ˜¯ç¬¬ä¸€ä¼˜å…ˆçº§ |

ğŸ“Œ **ä½ ç°åœ¨çš„æœ€ä½³é€‰å‹**

> `std::thread + std::async + (std::queue å°è£…)`  
> æ¶æ„æ€§ã€è§£å†³90%é—®é¢˜ã€‘ ï¼ å·¥ç¨‹ç‚«æŠ€ã€æé«˜10%æ€§èƒ½ã€‘

---

## ğŸ”¥ ä¸ºä»€ä¹ˆç»Ÿä¸€ä½¿ç”¨ std::queueï¼Ÿ

**MVPé˜¶æ®µç»Ÿä¸€ä½¿ç”¨æ ‡å‡†åº“çš„åŸå› **ï¼š

- âœ… **ç®€å•å¯é **ï¼šæ ‡å‡†åº“ï¼Œæ— éœ€é¢å¤–ä¾èµ–
- âœ… **æ€§èƒ½è¶³å¤Ÿ**ï¼šMVPé˜¶æ®µäº‹ä»¶é¢‘ç‡ä¸é«˜ï¼Œ`std::queue + std::mutex` å®Œå…¨å¤Ÿç”¨
- âœ… **ç»Ÿä¸€æ¶æ„**ï¼šä¸¤ä¸ªé˜Ÿåˆ—éƒ½ç”¨åŒæ ·çš„å®ç°ï¼Œé™ä½å¤æ‚åº¦
- âœ… **æ˜“äºç»´æŠ¤**ï¼šæ ‡å‡†åº“ï¼Œå›¢é˜Ÿç†Ÿæ‚‰ï¼Œé—®é¢˜å°‘
- âœ… **æŠ€æœ¯å†³ç­–**ï¼šä¸ä½¿ç”¨æ— é”é˜Ÿåˆ—ï¼ˆmoodycamel ç³»åˆ—ï¼‰ï¼Œè¯¦è§ [æ¶ˆæ¯é˜Ÿåˆ—é€‰å‹æŠ€æœ¯å†³ç­–.md](../guides/æ¶ˆæ¯é˜Ÿåˆ—é€‰å‹æŠ€æœ¯å†³ç­–.md)

**ä¸€å¥è¯**ï¼š

> **æˆ‘ä»¬æ˜¯"é æ¶æ„é¿å‘"ï¼Œä¸æ˜¯"é åº“æ•‘å‘½"ã€‚**  
> **MVPé˜¶æ®µï¼Œç®€å•å¯é  > æ€§èƒ½ç‚«æŠ€ã€‚**

**æŠ€æœ¯å†³ç­–**ï¼š
- âœ… é¡¹ç›®ç»Ÿä¸€ä½¿ç”¨ `std::queue + std::mutex + condition_variable`ï¼ˆæ ‡å‡†åº“ï¼‰
- âœ… ä¸ä½¿ç”¨æ— é”é˜Ÿåˆ—ï¼ˆmoodycamel ç³»åˆ—ï¼‰
- âœ… è¯¦è§ [æ¶ˆæ¯é˜Ÿåˆ—é€‰å‹æŠ€æœ¯å†³ç­–.md](../guides/æ¶ˆæ¯é˜Ÿåˆ—é€‰å‹æŠ€æœ¯å†³ç­–.md)
- âœ… ä½†å½“å‰MVPé˜¶æ®µä¸éœ€è¦

è¯¦è§ï¼š[äº‹ä»¶æ¶æ„è§„èŒƒ.md](./äº‹ä»¶æ¶æ„è§„èŒƒ.md)

---

## âš™ï¸ å¹¶å‘å®‰å…¨æ€§ç­–ç•¥ï¼ˆå¼ºåˆ¶è¦æ±‚ï¼‰

| é—®é¢˜ç±»å‹ | è§£å†³æ‰‹æ®µ | å†™å…¥æ–¹ |
|---------|---------|--------|
| çŠ¶æ€ç«äº‰ | å•æ’­æ”¾å™¨çº¿ç¨‹ä¸²è¡Œæ‰§è¡Œ | ä¸šåŠ¡ä¸å¯è§ |
| UIè·¨çº¿ç¨‹æ›´æ–° | UiEventQueue â†’ UIå®šå‘æ´¾å‘ | è‡ªåŠ¨ |
| SDKéšæœºå›è°ƒ | ç»Ÿä¸€å…¥å£ã€äº‹ä»¶ç¿»è¯‘ â†’ UiEventQueue | PlayerAdapterImpl |
| éæ³•çŠ¶æ€è°ƒç”¨ | å†…å»ºçŠ¶æ€æœº + å¿½ç•¥/é™çº§é€»è¾‘ | å¹³å°å±‚ |

> **ä¸šåŠ¡å±‚å§‹ç»ˆæ— é”ã€æ— è·¨çº¿ç¨‹æ€è€ƒéœ€æ±‚ã€‚**

---

## ğŸ“Š æ¶æ„ä¼˜åŠ¿æ€»ç»“

### å¯¹ä¸šåŠ¡å¼€å‘è€…çš„ä¼˜åŠ¿

- âœ… **é›¶å¹¶å‘çŸ¥è¯†è¦æ±‚**ï¼šåªéœ€è°ƒç”¨ `Player::play()`ï¼Œä¸éœ€è¦äº†è§£çº¿ç¨‹
- âœ… **çŠ¶æ€ä¸€è‡´æ€§ä¿è¯**ï¼šæ‰€æœ‰æ’­æ”¾å™¨æ“ä½œä¸²è¡Œæ‰§è¡Œï¼Œä¸ä¼šå‡ºç°ç«æ€æ¡ä»¶
- âœ… **äº‹ä»¶é©±åŠ¨æ¸…æ™°**ï¼šUIåªéœ€ç›‘å¬ `UiEventQueue`ï¼Œè‡ªåŠ¨æ¥æ”¶æ‰€æœ‰çŠ¶æ€æ›´æ–°

### å¯¹æ¶æ„çš„ä¼˜åŠ¿

- âœ… **å¯æ‰©å±•æ€§å¼º**ï¼šæœªæ¥å¯ä»¥è½»æ¾æ·»åŠ æ–°çš„å‘½ä»¤ç±»å‹æˆ–äº‹ä»¶ç±»å‹
- âœ… **æµ‹è¯•å‹å¥½**ï¼šå‘½ä»¤é˜Ÿåˆ—å’Œäº‹ä»¶é˜Ÿåˆ—å¯ä»¥ç‹¬ç«‹æµ‹è¯•
- âœ… **ç»´æŠ¤æˆæœ¬ä½**ï¼šæ¶æ„æ¸…æ™°ï¼Œé—®é¢˜å®šä½å®¹æ˜“

### å¯¹é¡¹ç›®çš„ä¼˜åŠ¿

- âœ… **MVPå¿«é€Ÿäº¤ä»˜**ï¼šä½¿ç”¨æ ‡å‡†åº“ï¼Œæ— éœ€é¢å¤–ä¾èµ–
- âœ… **é£é™©å¯æ§**ï¼šé¿å…å¤æ‚çš„é”æœºåˆ¶ï¼Œé™ä½bugæ¦‚ç‡
- âœ… **å›¢é˜Ÿå‹å¥½**ï¼šJava/WebèƒŒæ™¯çš„å¼€å‘è€…ä¹Ÿèƒ½å¿«é€Ÿä¸Šæ‰‹

---

## ğŸ“Œ ä¸€å¥è¯æ€»ç»“ï¼ˆç»™ä¸åŒè§’è‰²ï¼‰

### ç»™è€æ¿/è´¢åŠ¡çš„æ€»ç»“

> æˆ‘ä»¬ç°åœ¨é‡‡ç”¨**åŒé˜Ÿåˆ— + å•æ¶ˆè´¹è€…ä¸²è¡Œ + UIäº‹ä»¶å›æµ**æ¨¡å¼ï¼š
> - ä¿è¯æ’­æ”¾å™¨è°ƒç”¨çš„é¡ºåºä¸€è‡´æ€§
> - ä¸è®©ä¸šåŠ¡å·¥ç¨‹å¸ˆæ¥è§¦å¹¶å‘ä¸é”
> - é¿å…tplayeråŸç”Ÿçº¿ç¨‹å®‰å…¨ä¸å¯æ§çš„é£é™©
> - ä¸ºæœªæ¥æ‰©å±•æ£®æ—å¼å¹¶å‘ç•™æ¥å£
>
> **è¿™æ˜¯å›¢é˜Ÿè®¤çŸ¥æˆæœ¬å¯æ§ã€å¯é æ€§æœ€é«˜ã€å·¥ç¨‹æŠ•å…¥æœ€çœçš„æ–¹æ¡ˆã€‚**

### ç»™æ¶æ„å¸ˆçš„æ€»ç»“

> è¯¥é€‰å‹ä¼˜å…ˆé™ä½ç³»ç»Ÿå¤æ‚åº¦å’Œç»´æŠ¤æˆæœ¬ï¼Œé¿å…å› çº¿ç¨‹ç«äº‰å¼•å…¥éšæ€§è´¨é‡æˆæœ¬ï¼Œ
> **å®ç°"æ¶æ„é¿é™©ï¼Œæœ€å°æˆæœ¬å¯é äº¤ä»˜"ã€‚**

### ç»™å¼€å‘è€…çš„æ€»ç»“

> UIåªç®¡å‘å‘½ä»¤ï¼Œæ’­æ”¾å™¨åªç®¡ä¸²è¡Œæ‰§è¡Œï¼ŒSDKäº‹ä»¶åªå›UIæ›´æ–°ã€‚
> **æ•´ä¸ªç³»ç»Ÿä¸å…è®¸æ¨ªå‘æ€è€ƒçŠ¶æ€ï¼Œåªå…è®¸çºµå‘æµè½¬ã€‚**

---

## ğŸ”§ å®ç°ç»†èŠ‚

### 1. PlayerCmdQueue å®ç°

```cpp
class PlayerCmdQueue {
public:
    void push(const PlayerCmd& cmd);
    bool pop(PlayerCmd& cmd);  // éé˜»å¡
    bool empty() const;
    
private:
    std::queue<PlayerCmd> queue_;
    std::mutex mutex_;  // ä»…é˜Ÿåˆ—æ“ä½œéœ€è¦é”
    std::condition_variable cv_;
};
```

### 2. UiEventQueue å®ç°

```cpp
class UiEventQueue {
public:
    void push(const PlayerEvent& event);
    void processAll(std::function<void(const PlayerEvent&)> handler);
    
private:
    std::queue<PlayerEvent> queue_;
    std::mutex mutex_;  // ä»…é˜Ÿåˆ—æ“ä½œéœ€è¦é”
};
```

### 3. æ’­æ”¾å™¨çº¿ç¨‹å®ç°

```cpp
void playerThread() {
    PlayerCmd cmd;
    while (running_) {
        if (PlayerCmdQueue::getInstance().pop(cmd)) {
            // ä¸²è¡Œæ‰§è¡Œå‘½ä»¤
            executeCommand(cmd);
        } else {
            std::this_thread::sleep_for(std::chrono::milliseconds(10));
        }
    }
}
```

### 4. UIäº‹ä»¶å¤„ç†

```cpp
void uiMainLoop() {
    while (running_) {
        // LVGLäº‹ä»¶å¤„ç†
        lv_timer_handler();
        
        // å¤„ç†æ’­æ”¾å™¨äº‹ä»¶
        UiEventQueue::getInstance().processAll([](const PlayerEvent& event) {
            updateUI(event);
        });
        
        std::this_thread::sleep_for(std::chrono::milliseconds(10));
    }
}
```

---

## ğŸ“ˆ æ€§èƒ½è€ƒè™‘

### é˜Ÿåˆ—å¤§å°é™åˆ¶

- **PlayerCmdQueue**ï¼šæœ€å¤š10ä¸ªå‘½ä»¤ï¼ˆé˜²æ­¢å‘½ä»¤å †ç§¯ï¼‰
- **UiEventQueue**ï¼šæœ€å¤š50ä¸ªäº‹ä»¶ï¼ˆé˜²æ­¢UIæ›´æ–°å»¶è¿Ÿï¼‰

### çº¿ç¨‹ä¼˜å…ˆçº§

- **UIä¸»çº¿ç¨‹**ï¼šæ­£å¸¸ä¼˜å…ˆçº§
- **æ’­æ”¾å™¨çº¿ç¨‹**ï¼šæ­£å¸¸ä¼˜å…ˆçº§
- **ç½‘ç»œçº¿ç¨‹**ï¼šä½ä¼˜å…ˆçº§ï¼ˆä¸å½±å“æ’­æ”¾ï¼‰

### å†…å­˜å ç”¨

- æ¯ä¸ªå‘½ä»¤ï¼š~64å­—èŠ‚
- æ¯ä¸ªäº‹ä»¶ï¼š~128å­—èŠ‚
- æ€»é˜Ÿåˆ—å†…å­˜ï¼š< 10KB

---

## ğŸš¨ æ³¨æ„äº‹é¡¹

### 1. å‘½ä»¤å»é‡

å¦‚æœè¿ç»­æ”¶åˆ°å¤šä¸ªç›¸åŒçš„å‘½ä»¤ï¼ˆå¦‚è¿ç»­ç‚¹å‡»æš‚åœï¼‰ï¼Œåº”è¯¥å»é‡æˆ–å¿½ç•¥ã€‚

### 2. äº‹ä»¶åˆå¹¶

å¦‚æœçŸ­æ—¶é—´å†…æ”¶åˆ°å¤šä¸ªç›¸åŒç±»å‹çš„äº‹ä»¶ï¼Œå¯ä»¥åˆå¹¶ä¸ºä¸€ä¸ªäº‹ä»¶ã€‚

### 3. é”™è¯¯å¤„ç†

- å‘½ä»¤æ‰§è¡Œå¤±è´¥æ—¶ï¼Œé€šè¿‡ `UiEventQueue` å‘é€é”™è¯¯äº‹ä»¶
- UIå±‚æ ¹æ®é”™è¯¯äº‹ä»¶æ˜¾ç¤ºé”™è¯¯æç¤º

### 4. çŠ¶æ€åŒæ­¥

- æ’­æ”¾å™¨çº¿ç¨‹ç»´æŠ¤å†…éƒ¨çŠ¶æ€æœº
- UIå±‚é€šè¿‡äº‹ä»¶é˜Ÿåˆ—è·å–æœ€æ–°çŠ¶æ€
- ä¸å…è®¸UIå±‚ç›´æ¥æŸ¥è¯¢æ’­æ”¾å™¨çŠ¶æ€

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **é¡¹ç›®æ¶æ„è®¾è®¡æ€»è§ˆ**: [é¡¹ç›®æ¶æ„è®¾è®¡æ€»è§ˆ.md](./é¡¹ç›®æ¶æ„è®¾è®¡æ€»è§ˆ.md)
- **çº¿ç¨‹ä¸äº‹ä»¶ç³»ç»Ÿè®¾è®¡**: [çº¿ç¨‹ä¸äº‹ä»¶ç³»ç»Ÿè®¾è®¡.md](../design/çº¿ç¨‹ä¸äº‹ä»¶ç³»ç»Ÿè®¾è®¡.md)
- **C++æ¶æ„è®¾è®¡**: [C++æ¶æ„è®¾è®¡-é¢„åˆ†é…å†…å­˜ç‰ˆæœ¬.md](./C++æ¶æ„è®¾è®¡-é¢„åˆ†é…å†…å­˜ç‰ˆæœ¬.md)
- **å¼€æºåº“é€‰å‹æŒ‡å—**: [å¼€æºåº“é€‰å‹æŒ‡å—.md](../guides/å¼€æºåº“é€‰å‹æŒ‡å—.md)

---

## ğŸ·ï¸ æ ‡ç­¾ï¼ˆç”¨äºæœç´¢/æ–‡æ¡£ç®¡ç†ï¼‰

`#KTVLV` `#F133` `#TinaLinux` `#LVGL`  
`#tplayer` `#std::thread` `#æ— é”ä¸šåŠ¡`  
`#äº‹ä»¶é©±åŠ¨` `#åŒé˜Ÿåˆ—æ¨¡å‹` `#æ¶æ„é¿å‘`  
`#çº¿ç¨‹æ¶æ„` `#æ¶ˆæ¯é˜Ÿåˆ—` `#å¹¶å‘è®¾è®¡`

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### é˜¶æ®µ1ï¼šæ ¸å¿ƒå®ç°ï¼ˆå½“å‰ï¼‰

1. âœ… å®ç° `PlayerCmdQueue` å’Œ `UiEventQueue`
2. âœ… å®ç°æ’­æ”¾å™¨çº¿ç¨‹å’Œå‘½ä»¤æ‰§è¡Œé€»è¾‘
3. âœ… å®ç°UIäº‹ä»¶å¤„ç†é€»è¾‘
4. âœ… é›†æˆTPlayer SDK

### é˜¶æ®µ2ï¼šå®Œå–„åŠŸèƒ½ï¼ˆåç»­ï¼‰

1. âš ï¸ æ·»åŠ å‘½ä»¤å»é‡å’Œäº‹ä»¶åˆå¹¶
2. âš ï¸ æ·»åŠ é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
3. âš ï¸ æ·»åŠ æ€§èƒ½ç›‘æ§å’Œæ—¥å¿—
4. âš ï¸ æ·»åŠ å•å…ƒæµ‹è¯•

### é˜¶æ®µ3ï¼šä¼˜åŒ–ï¼ˆæœªæ¥ï¼‰

1. âš ï¸ æ€§èƒ½ä¼˜åŒ–ï¼ˆå¦‚æœ neededï¼‰
2. âš ï¸ æ‰©å±•æ›´å¤šå‘½ä»¤ç±»å‹
3. âš ï¸ æ”¯æŒå¤šæ’­æ”¾å™¨å®ä¾‹ï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## ğŸ“„ æ–‡æ¡£ä¿¡æ¯

- **æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0
- **æœ€åæ›´æ–°**ï¼š2025-12-30
- **ç»´æŠ¤è€…**ï¼šæ¶æ„å›¢é˜Ÿ
- **å®¡æ ¸çŠ¶æ€**ï¼šâœ… å·²å®¡æ ¸

---

**æ€»ç»“**ï¼šè¯¥æ¶æ„è®¾è®¡é€šè¿‡åŒé˜Ÿåˆ—æ¨¡å‹å’Œå•æ¶ˆè´¹è€…ä¸²è¡Œæ‰§è¡Œï¼Œå®ç°äº†ä¸šåŠ¡å±‚æ— é”ã€çŠ¶æ€ä¸€è‡´æ€§ä¿è¯ã€å›¢é˜Ÿå‹å¥½ã€ç»´æŠ¤æˆæœ¬ä½çš„ç›®æ ‡ã€‚è¿™æ˜¯å½“å‰é˜¶æ®µæœ€ä¼˜çš„æ¶æ„é€‰å‹ã€‚

